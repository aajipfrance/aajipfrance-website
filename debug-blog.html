<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Diagnostic Blog - AAJIP-FRANCE</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 40px; line-height: 1.6; }
        .section { margin: 30px 0; padding: 20px; border: 1px solid #ddd; border-radius: 8px; }
        .success { color: green; }
        .error { color: red; }
        .warning { color: orange; }
        .info { color: blue; }
        .test-button { padding: 10px 20px; margin: 5px; background: #667eea; color: white; border: none; border-radius: 5px; cursor: pointer; }
        .test-button:hover { background: #5a67d8; }
        pre { background: #f5f5f5; padding: 10px; border-radius: 5px; overflow-x: auto; }
    </style>
</head>
<body>
    <h1>üîç Diagnostic du Blog AAJIP-FRANCE</h1>
    
    <div class="section">
        <h2>üìÅ V√©rification des fichiers</h2>
        <div id="fileCheck"></div>
    </div>
    
    <div class="section">
        <h2>üîó Test des liens</h2>
        <button class="test-button" onclick="testLink('index.html')">Tester index.html</button>
        <button class="test-button" onclick="testLink('blog.html')">Tester blog.html</button>
        <button class="test-button" onclick="testLink('article.html')">Tester article.html</button>
        <div id="linkTest"></div>
    </div>
    
    <div class="section">
        <h2>üìä Test du chargement JSON</h2>
        <button class="test-button" onclick="testJSON()">Tester articles.json</button>
        <div id="jsonTest"></div>
    </div>
    
    <div class="section">
        <h2>üé® Test des styles</h2>
        <div id="styleTest"></div>
    </div>
    
    <div class="section">
        <h2>üìù Logs de la console</h2>
        <div id="consoleLog"></div>
    </div>

    <script>
        // V√©rification des fichiers
        const filesToCheck = [
            'index.html',
            'blog.html', 
            'article.html',
            'blog.js',
            'blog-styles.css',
            'article-styles.css',
            'articles.json',
            'config.js',
            'script.js',
            'styles.css'
        ];
        
        async function checkFiles() {
            const fileCheckDiv = document.getElementById('fileCheck');
            fileCheckDiv.innerHTML = '<p>V√©rification en cours...</p>';
            
            let results = '';
            
            for (const file of filesToCheck) {
                try {
                    const response = await fetch(file);
                    if (response.ok) {
                        results += `<p class="success">‚úÖ ${file} - Accessible (${response.status})</p>`;
                    } else {
                        results += `<p class="error">‚ùå ${file} - Erreur ${response.status}: ${response.statusText}</p>`;
                    }
                } catch (error) {
                    results += `<p class="error">‚ùå ${file} - Erreur r√©seau: ${error.message}</p>`;
                }
            }
            
            fileCheckDiv.innerHTML = results;
        }
        
        // Test des liens
        async function testLink(url) {
            const linkTestDiv = document.getElementById('linkTest');
            linkTestDiv.innerHTML = `<p>Test de ${url} en cours...</p>`;
            
            try {
                const response = await fetch(url);
                if (response.ok) {
                    const text = await response.text();
                    const hasContent = text.length > 100;
                    linkTestDiv.innerHTML = `
                        <p class="success">‚úÖ ${url} - Accessible</p>
                        <p class="info">Taille: ${text.length} caract√®res</p>
                        <p class="info">Contenu valide: ${hasContent ? 'Oui' : 'Non'}</p>
                        <details>
                            <summary>Aper√ßu du contenu</summary>
                            <pre>${text.substring(0, 500)}...</pre>
                        </details>
                    `;
                } else {
                    linkTestDiv.innerHTML = `<p class="error">‚ùå ${url} - Erreur ${response.status}: ${response.statusText}</p>`;
                }
            } catch (error) {
                linkTestDiv.innerHTML = `<p class="error">‚ùå ${url} - Erreur r√©seau: ${error.message}</p>`;
            }
        }
        
        // Test du JSON
        async function testJSON() {
            const jsonTestDiv = document.getElementById('jsonTest');
            jsonTestDiv.innerHTML = '<p>Test du JSON en cours...</p>';
            
            try {
                const response = await fetch('articles.json');
                if (response.ok) {
                    const data = await response.json();
                    const articleCount = data.articles ? data.articles.length : 0;
                    const categoryCount = data.categories ? data.categories.length : 0;
                    
                    jsonTestDiv.innerHTML = `
                        <p class="success">‚úÖ articles.json - Charg√© avec succ√®s</p>
                        <p class="info">Articles: ${articleCount}</p>
                        <p class="info">Cat√©gories: ${categoryCount}</p>
                        <details>
                            <summary>Structure des donn√©es</summary>
                            <pre>${JSON.stringify(data, null, 2).substring(0, 1000)}...</pre>
                        </details>
                    `;
                } else {
                    jsonTestDiv.innerHTML = `<p class="error">‚ùå articles.json - Erreur ${response.status}: ${response.statusText}</p>`;
                }
            } catch (error) {
                jsonTestDiv.innerHTML = `<p class="error">‚ùå articles.json - Erreur: ${error.message}</p>`;
            }
        }
        
        // Test des styles
        function testStyles() {
            const styleTestDiv = document.getElementById('styleTest');
            const styles = ['styles.css', 'blog-styles.css', 'article-styles.css'];
            
            let results = '';
            styles.forEach(style => {
                const link = document.createElement('link');
                link.rel = 'stylesheet';
                link.href = style;
                link.onload = () => {
                    results += `<p class="success">‚úÖ ${style} - Charg√©</p>`;
                    styleTestDiv.innerHTML = results;
                };
                link.onerror = () => {
                    results += `<p class="error">‚ùå ${style} - Erreur de chargement</p>`;
                    styleTestDiv.innerHTML = results;
                };
                document.head.appendChild(link);
            });
        }
        
        // Capture des logs de console
        const originalLog = console.log;
        const originalError = console.error;
        const consoleLogDiv = document.getElementById('consoleLog');
        
        console.log = function(...args) {
            originalLog.apply(console, args);
            consoleLogDiv.innerHTML += `<p class="info">LOG: ${args.join(' ')}</p>`;
        };
        
        console.error = function(...args) {
            originalError.apply(console, args);
            consoleLogDiv.innerHTML += `<p class="error">ERROR: ${args.join(' ')}</p>`;
        };
        
        // Initialisation
        document.addEventListener('DOMContentLoaded', function() {
            checkFiles();
            testStyles();
            
            // Test automatique du blog
            setTimeout(() => {
                testLink('blog.html');
                testJSON();
            }, 1000);
        });
    </script>
</body>
</html>
